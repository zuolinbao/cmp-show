"use strict";(self["webpackChunkcmp"]=self["webpackChunkcmp"]||[]).push([[840],{74597:function(e,t,r){r.d(t,{Z:function(){return p}});var a=function(){var e=this,t=e._self._c;return t("el-dropdown",{staticClass:"fr",attrs:{"hide-on-click":!0,size:e.size,trigger:"click"}},[t("el-button",{attrs:{plain:"",size:e.size,disabled:e.disabled}},[e._v(" "+e._s(e.$t("common.export"))),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{nativeOn:{click:function(t){return e.exportCsv.apply(null,arguments)}}},[e._v("CSV")]),t("el-dropdown-item",{nativeOn:{click:function(t){return e.exportTxt.apply(null,arguments)}}},[e._v("TXT")])],1)],1)},l=[],o=(r(70560),r(45101)),s={components:{},props:{queryIdList:{type:Array,default:()=>[]},size:{type:String,default:""},disabled:{type:Boolean,default:!1},params:{type:Object,default:()=>({})},sheetName:{type:String,default:null},queryId:{type:[Number,String],default:""},showProd:{type:String,default:""}},data(){return{}},computed:{},methods:{exportCsv(){this.exprt("csv")},exportTxt(){this.exprt("txt")},async exprt(e,t){const r={queryId:this.queryId,fileType:e,...this.params};let a=[];a="2040"===this.queryId?await(0,o.Z)("/prodInst/exportSimCardList",r,{method:"post"}):await(0,o.Z)("/batch/export",r,{method:"get"}),a&&a.length>0?this.errAlert(a):this.success()},success(){const e=this,t=this.$createElement;this.$msgbox({title:this.$t("batchUpload.actionSuccess"),type:"success",center:!0,message:t("p",{class:"fs12"},[this.$t("batchUpload.task"),t("a",{class:"cor-blue",on:{click:e.viewProgress}},this.$t("batchUpload.process"))]),showCancelButton:!1,confirmButtonText:this.$t("batchUpload.know")}).then((()=>{})).catch((()=>{}))},viewProgress(){this.$msgbox.close(),this.$router.push("/common/download")},errAlert(e){const t=this.$createElement,r=t("div",{class:"error-msg-box"},[...function(){const r=[];return e.forEach((e=>{r.push(t("p",{class:"cor-red"},e))})),r}()]);this.$msgbox({title:this.$t("batchUpload.exportFail"),type:"warning",center:!0,message:r,showCancelButton:!1,confirmButtonText:this.$t("batchUpload.know")}).then((()=>{})).catch((()=>{}))}}},n=s,i=r(43736),u=(0,i.Z)(n,a,l,!1,null,"a1e0ae6e",null),p=u.exports},94840:function(e,t,r){r.r(t),r.d(t,{default:function(){return d}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("div",{staticClass:"container-form"},[t("el-form",{ref:"qryParamRef",attrs:{model:e.qryParam,size:"small"}},[t("div",{staticClass:"row-container"},[t("div",{staticClass:"left-row"},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:e.$t("rule.ruleName"),prop:"ruleName"}},[t("el-input",{attrs:{placeholder:e.$t("rule.enter")+e.$t("rule.ruleName")},model:{value:e.qryParam.ruleName,callback:function(t){e.$set(e.qryParam,"ruleName",t)},expression:"qryParam.ruleName"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:e.$t("rule.supplier"),prop:"supplierNbr"}},[t("ct-async-select",{attrs:{placeholder:e.selectPh("rule.supplier"),url:"/prodInst/getSupplierListForQuery",method:"get","label-key":"attrValueName","value-key":"attrValue"},model:{value:e.qryParam.supplierNbr,callback:function(t){e.$set(e.qryParam,"supplierNbr",t)},expression:"qryParam.supplierNbr"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:e.$t("rule.ruleCategory"),prop:"ruleType"}},[t("ct-select",{attrs:{placeholder:e.$t("rule.pleaseSelect"),options:e.ruleTypeOptions},model:{value:e.qryParam.ruleType,callback:function(t){e.$set(e.qryParam,"ruleType",t)},expression:"qryParam.ruleType"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:e.$t("rule.ruleType"),prop:"ruleSubType"}},[t("ct-select",{attrs:{placeholder:e.$t("rule.pleaseSelect"),options:e.subTypeOptions},model:{value:e.qryParam.ruleSubType,callback:function(t){e.$set(e.qryParam,"ruleSubType",t)},expression:"qryParam.ruleSubType"}})],1)],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.powerSearch,expression:"powerSearch"}],staticClass:"more-query-group"},[t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:e.$t("rule.triggerTime"),prop:"beginSendTime"}},[t("ct-date-picker",{attrs:{begin:e.qryParam.beginSendTime,end:e.qryParam.endSendTime},on:{"update:begin":function(t){return e.$set(e.qryParam,"beginSendTime",t)},"update:end":function(t){return e.$set(e.qryParam,"endSendTime",t)}}})],1)],1)],1)],1)],1),t("div",{staticClass:"right-row"},[t("el-form-item",{attrs:{"label-width":"0"}},[t("div",{staticClass:"search-button-group"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.qryCmpParamPage(!1)}}},[e._v(e._s(e.$t("rule.query")))]),t("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:e.reset}},[e._v(e._s(e.$t("rule.resetting")))]),t("show-more-button",{model:{value:e.powerSearch,callback:function(t){e.powerSearch=t},expression:"powerSearch"}})],1)])],1)]),t("div",{staticClass:"tool-button-group"},[t("BatchExport",{attrs:{"query-id":2060,params:e.qryParam,"show-msg":0===e.tableData.length}})],1)]),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"table",staticClass:"container-table",attrs:{"element-loading-text":e.$t("rule.loading"),data:e.tableData,border:!0,"overflow-x":"scroll",height:"100%"}},[t("el-table-column",{attrs:{prop:"ruleName",label:e.$t("rule.ruleName"),"show-overflow-tooltip":"","min-width":"110"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("a",{staticClass:"cor-blue",on:{click:function(t){return e.goDetail(r.row)}}},[e._v(e._s(r.row.ruleName))])]}}])}),t("el-table-column",{attrs:{prop:"supplierNbrDesc",label:e.$t("rule.supplier"),"show-overflow-tooltip":"","min-width":"150"}}),t("el-table-column",{attrs:{prop:"ruleType",label:e.$t("rule.ruleCategory"),"show-overflow-tooltip":"","min-width":"70",formatter:e.rowFormatter}}),t("el-table-column",{attrs:{prop:"ruleSubType",label:e.$t("rule.ruleType"),"show-overflow-tooltip":"","min-width":"70",formatter:e.rowFormatter}}),t("el-table-column",{attrs:{prop:"objType",label:e.$t("rule.objectType"),"show-overflow-tooltip":"","min-width":"70",formatter:e.rowFormatter}}),t("el-table-column",{attrs:{prop:"sendTime",label:e.$t("rule.triggerTime"),"show-overflow-tooltip":"","min-width":"110"}}),t("el-table-column",{attrs:{prop:"msisdn",label:"MSISDN","show-overflow-tooltip":"","min-width":"110"}}),t("el-table-column",{attrs:{prop:"msgInfo",label:e.$t("rule.pushMsg"),"show-overflow-tooltip":"","min-width":"110"}})],1),t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.tableData.length>0,expression:"tableData.length > 0"}],attrs:{background:"","current-page":e.page.pageIndex,align:"right","page-sizes":[10,20,50,100],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.page.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])},l=[],o=(r(70560),r(80289)),s=r(41090),n=r(63438),i=r(74597),u={components:{BatchExport:i.Z},mixins:[s.Z,n.Z],data(){return{powerSearch:!1,loading:!1,page:{pageIndex:1,pageSize:10,total:0},tableData:[],qryParam:{ruleName:"",supplierNbr:"",extCusId:"",ruleType:"",ruleSubType:"",beginSendTime:"",endSendTime:""}}},mounted(){this.qryCmpParamPage(!1)},methods:{goDetail(e){this.$router.push({path:"enforcementDetail",query:{custId:e.custId,recordId:e.recordId}})},formatRoleType(e){return""},qryCmpParamPage(e){e||(this.page.pageIndex=1,this.page.pageSize=10);const t={...this.qryParam,...this.page};this.loading=!0,this.$api.rule.qryRuleRecordList(t).then((e=>{e.list&&e.list.length>0?(this.tableData=e.list,this.page.total=e.total):(this.tableData=[],this.page.total=0)})).finally((()=>{this.loading=!1}))},handleSizeChange(e){this.page.pageSize=e,this.page.pageIndex=1,this.qryCmpParamPage(!0)},handleCurrentChange(e){this.page.pageIndex=e,this.qryCmpParamPage(!0)},reset(){this.$refs.qryParamRef.resetFields(),this.qryCmpParamPage(!1)},rowFormatter(e,t,r){return"ruleType"===t.property?this.$t((0,o.IC)(e.ruleType))||e.ruleTypeName:"ruleSubType"===t.property?this.$t((0,o.hG)(e.ruleSubType))||e.ruleSubTypeName:"objType"===t.property?e.objTypeName?this.$t((0,o.ZN)(e.objType))||e.objTypeName:"":"extCustId"===t.property?"zh"===this.$i18n.locale?e.supplierCustChineseName:e.supplierCustEnglishName:r}}},p=u,c=r(43736),m=(0,c.Z)(p,a,l,!1,null,"9c08d0a4",null),d=m.exports},80289:function(e,t,r){r.d(t,{IC:function(){return C},T8:function(){return T},X8:function(){return q},Xp:function(){return f},ZN:function(){return v},b6:function(){return S},ex:function(){return w},hG:function(){return $},hR:function(){return x},o3:function(){return P}});const a=101,l=201,o=301,s=102,n=501,i=502,u=601,p=1,c=2,m=3,d=5,h=6,g=1,b=2,y=3;function f(e){return[u,n,s,i].find((t=>t===e))}function w(e){const t={[a]:p,[l]:c,[o]:m,[s]:p,[n]:d,[i]:d,[u]:h};return t[e]}function v(e){return e===g?"rule.enterprise":e===b?"rule.package":e===y?"rule.simCard":""}const T={[a]:"rule.monthDataUsage",[l]:"rule.monthSmsUsage",[o]:"rule.monthVoiceUsage",[u]:"rule.packageExpire",[n]:"rule.simStatusChange",[i]:"rule.deviceChange",[s]:"rule.monthOverflow"};function $(e){return T[e]||""}const x={[p]:"rule.dataRuleType",[c]:"rule.smsRuleType",[m]:"rule.voiceRuleType",[d]:"rule.cardRuleType",[h]:"rule.package"};function C(e){return x[e]}function S(e){return e===a?"rule.dataUnit":e===l?"rule.smsUnit":e===o?"rule.voiceUnit":""}function q(e){return`rule.sendState${e}`}function P(e){e.objId=e.offerId,e.objDesc=e.offerName}},63438:function(e,t,r){var a=r(80289);t.Z={computed:{subTypeOptions(){return Object.entries(a.T8).map((([e,t])=>{const r=this.$t(t);return{value:Number(e),label:r}}))},ruleTypeOptions(){return Object.entries(a.hR).map((([e,t])=>{const r=this.$t(t);return{value:Number(e),label:r}}))}}}}}]);
//# sourceMappingURL=840.1e83d630.js.map