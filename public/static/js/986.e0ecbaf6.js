"use strict";(self["webpackChunkcmp"]=self["webpackChunkcmp"]||[]).push([[986],{51122:function(e,t,a){a.d(t,{Z:function(){return u}});var i=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{"close-on-click-modal":!1,title:e.title,visible:e.v,"append-to-body":!0,width:"840px",top:"10vh"},on:{"update:visible":function(t){e.v=t}}},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":e.$t("batchUpload.uploading")}},[t("p",{staticClass:"download-tip"},[e._v(" "+e._s(e.$t("batchUpload.please"))),t("a",{staticClass:"cor-blue",attrs:{target:"_self"},on:{click:e.downloadTpl}},[e._v(e._s(e.$t("batchUpload.downloadTpl")))]),e._v(e._s(e.$t("batchUpload.please2"))+" ")]),t("div",{staticClass:"tip"},[t("i",{staticClass:"icon-zhuyi",staticStyle:{color:"orange"}}),t("p",{staticClass:"upload-tip"},[e._v(" "+e._s(e.$t("batchUpload.warmTip"))),t("br"),e._t("tip")],2)]),t("div",{staticClass:"upload-box"},[t("el-upload",{ref:"upload",staticClass:"upload-wrap",attrs:{drag:"",accept:".xls,.xlsx",action:e.action,data:e.extraParam,"show-file-list":!0,multiple:!1,"auto-upload":!1,"file-list":e.fileList,"on-change":e.handlerChange,"on-remove":e.handleRemove,"on-progress":e.handlerProgress,"on-success":e.handlerSuccess,"on-error":e.handlerError,"before-upload":e.beforeUpload}},[t("div",{staticClass:"upload_file_choose"},[t("i",{staticClass:"el-icon-upload cor-blue"}),t("div",{staticClass:"upload_file_choose_text"},[e._v(" "+e._s(e.$t("batchUpload.drag1"))),t("em",[e._v(e._s(e.$t("batchUpload.drag2")))]),t("br"),t("span",{staticClass:"support-tip"},[e._v(e._s(e.supportFormat))])])])])],1),t("div",{staticClass:"download-template"},[t("el-button",{attrs:{type:"text",icon:"icon-xiazai1"},on:{click:e.downloadTpl}},[e._v(e._s(e.$t("batchUpload.downloadTpl"))+" ")])],1)]),t("span",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",disabled:e.disableSubmit},on:{click:e.submit}},[e._v(e._s(e.$t("batchUpload.submit")))]),t("el-button",{on:{click:function(t){e.v=!1}}},[e._v(e._s(e.$t("common.cancel")))])],1)])},s=[],l=(a(70560),{components:{},props:{visible:{type:Boolean,default:!1},queryId:{type:[String,Number],default:""},downloadUrl:{type:String,default:"/batch/downloadTpl/"},uploadUrl:{type:String,default:"/batch/import"},maxFileSize:{type:Number,default:10485760},title:{type:String,default:""},param:{type:Object,default:()=>{}},isXls:{type:Boolean,default:!1},isRuleBatch:{type:Boolean,default:!1}},data(){return{uploaded:!1,loading:!1,fileName:"",fileSize:0,fileList:[]}},computed:{v:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e),e||(this.fileList=[])}},supportFormat(){return this.$t("batchUpload.drag3")+" "+(this.isXls?".xls":".xlsx")},action(){return"/api"+this.uploadUrl},isSpecial(){return"/simCard/upload"===this.uploadUrl||"/order/upload"===this.uploadUrl},disableSubmit(){return!this.fileName||this.loading},extraParam(){return this.isSpecial||this.isRuleBatch?{templateId:this.queryId,...this.param}:{queryId:this.queryId,...this.param}},showPreview(){return!this.uploaded&&this.fileName},fileSizeFormat(){return this.fileSize>1048576?(this.fileSize/1024/1024).toFixed(2)+"MB":(this.fileSize/1024).toFixed(2)+"KB"}},methods:{downloadTpl(){window.open(this.downloadUrl+this.queryId,"_self")},handlerProgress(e,t,a){this.loading=!0,this.fileName=t.name,this.fileSize=t.size},handlerChange(e,t){console.log("handlerChange",e,t),t.length>1&&t.splice(0,1),this.uploaded||(this.fileName=e.name,this.fileSize=e.size)},handleRemove(e,t){this.resetUpload()},handlerSuccess(e,t,a){if(e.data&&e.data.length>0)return void this.errAlert(e.data);if("0"!=e.code&&e.message)return void this.errAlert(e.message);this.uploaded=!0;const i=setTimeout((()=>{this.loading=!1,clearTimeout(i)}),200);if(this.isSpecial)this.$message.success(this.$t("batchUpload.subtmitSuccess")),this.uploaded=!1,this.v=!1;else{const e=this,t=this.$createElement;this.$msgbox({title:this.$t("batchUpload.subtmitSuccess"),type:"success",center:!0,message:t("p",{class:"fs12"},[this.$t(this.isRuleBatch?"batchUpload.task2":"batchUpload.task"),t("a",{class:"cor-blue",on:{click:e.viewProgress}},this.$t("batchUpload.process"))]),showCancelButton:!1,confirmButtonText:this.$t("batchUpload.know")}).then((()=>{this.uploaded=!1,this.v=!1})).catch((()=>{}))}},resetUpload(){this.$refs.upload.clearFiles(),this.uploaded=!1,this.fileName="",this.fileSize=0},showErrMsg(e){this.$msgbox({title:this.$t("batchUpload.subtmitFail"),type:"warning",center:!0,message:e,showCancelButton:!1,confirmButtonText:this.$t("batchUpload.know")})},handlerError(e){const t=setTimeout((()=>{this.loading=!1,clearTimeout(t)}),200);let a=this.$t("batchUpload.systemError");if(e.message){const t=JSON.parse(e.message);t&&t.message&&(a+="，"+t.message)}this.showErrMsg(a),this.$nextTick(this.resetUpload)},errAlert(e){this.$nextTick(this.resetUpload);const t=setTimeout((()=>{this.loading=!1,clearTimeout(t)}),200),a=this.$createElement,i=a("div",{class:"error-msg-box"},[...function(){const t=[];return e.forEach((e=>{t.push(a("p",{class:"cor-red"},e))})),t}()]);this.showErrMsg(i)},toReload(){this.resetUpload()},submit(){this.$refs.upload.submit()},beforeUpload(e){if(this.fileSize>this.maxFileSize){let e="";return e=this.maxFileSize>1048576?this.maxFileSize/1024/1024+"MB":this.maxFileSize/1024+"KB",this.$message.error(this.$t("batchUpload.fileSize")+e),!1}return"application/vnd.ms-excel"===e.type||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===e.type||(this.$message.error(this.$t("batchUpload.fileType")),!1)},viewProgress(){this.uploaded=!1,this.v=!1,this.$msgbox.close(),this.isRuleBatch?this.$router.push({path:"/order/orderBatch",query:{activeTab:"2"}}):this.$router.push("/common/download")}}}),r=l,o=a(43736),n=(0,o.Z)(r,i,s,!1,null,"79240383",null),u=n.exports},16986:function(e,t,a){a.r(t),a.d(t,{default:function(){return p}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("div",{staticClass:"box-one"},[t("div",{staticClass:"one-title"},[e._v(e._s(e.$route.query.supplierNbrDesc))]),t("div",{staticClass:"one-arrange"},[t("el-row",e._l(e.defineList,(function(a,i){return t("el-col",{key:i,attrs:{span:6}},[t("div",{staticClass:"arrange-title"},[e._v(e._s(a.name))]),t("div",{staticClass:"arrange-box"},[e._v(" "+e._s(a.value?a.value:a.formatter())+" ")])])})),1),t("el-row",[t("el-col",{attrs:{span:24}},[t("div",{staticClass:"arrange-title"},[e._v(e._s(e.$t("rule.pushURL")))]),t("div",{staticClass:"arrange-box"},[e._v(e._s(e.detailData.actionDest))])])],1)],1)]),e.tableVisible?t("div",{staticClass:"box-two"},[t("div",{staticClass:"two-title"},[e._v(e._s(e.$t("rule.ruleObject")))]),t("div",{staticClass:"table-btn"},[t("el-button",{staticClass:"btn-blue",attrs:{icon:"el-icon-edit-outline",size:"small"},on:{click:function(t){return e.clickUpload(2e3)}}},[e._v(e._s(e.$t("rule.batchImport")))]),t("el-button",{staticClass:"btn-red",attrs:{icon:"el-icon-delete",size:"small"},on:{click:function(t){return e.clickUpload(2001)}}},[e._v(e._s(e.$t("rule.batchDelete")))])],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"table",staticClass:"container-table",attrs:{"element-loading-text":e.$t("rule.loading"),data:e.tableData,border:!0,"overflow-x":"scroll",height:"483px"}},[t("el-table-column",{attrs:{prop:"iccid",label:"ICCID","show-overflow-tooltip":"","min-width":"110"}}),t("el-table-column",{attrs:{prop:"msisdn",label:e.$t("rule.accNumber"),"show-overflow-tooltip":"","min-width":"110"}})],1),t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.tableData.length>0,expression:"tableData.length > 0"}],attrs:{background:"","current-page":e.page.pageIndex,align:"right","page-sizes":[10,20,50,100],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.page.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1):e._e(),t("BatchUpload",{attrs:{visible:e.showUpload,"query-id":e.queryId,"is-rule-batch":!0,"download-url":"/order/download/","upload-url":"/ruleCommon/upload","max-file-size":10485760,param:e.param,title:2e3===e.queryId?e.$t("rule.batchImportNumber"):e.$t("rule.batchDeleteNumber")},on:{"update:visible":function(t){e.showUpload=t}},scopedSlots:e._u([{key:"tip",fn:function(){return[e._v(" 1、"+e._s(e.$t("batchUpload.uploadTip1"))),t("br"),e._v(" 2、"+e._s(e.$t("batchUpload.uploadTip2"))),t("br"),e._v(" 3、"+e._s(e.$t("batchUpload.uploadTip3"))),t("br"),e._v(" 4、"+e._s(e.$t("batchUpload.uploadTip4"))+" ")]},proxy:!0}])})],1)},s=[],l=(a(70560),a(51122)),r=a(48076),o=a(80289),n={components:{BatchUpload:l.Z},data(){return{page:{pageIndex:1,pageSize:10,total:0},showUpload:!1,queryId:"",detailData:{},tableVisible:!0,tableData:[],loading:!1}},computed:{defineList(){const e=[{name:this.$t("rule.ruleName"),formatter:()=>this.detailData.ruleName},{name:this.$t("rule.ruleCategory"),formatter:()=>this.$t((0,o.IC)(this.detailData.ruleType))},{name:this.$t("rule.ruleType"),formatter:()=>this.$t((0,o.hG)(this.detailData.ruleSubType))},{name:this.$t("rule.objectType"),formatter:()=>this.detailData.objTypeName}];if(!o.Xp){const t=this.detailData.ruleValue?this.detailData.ruleValue.split(",").map(((e,t)=>({name:`${this.$t("rule.threshold")}${t+1||""}(${this.unitName})`,value:e}))):[];t.length&&e.push(...t)}return e},unitName(){return this.$t((0,o.b6)(this.detailData.ruleSubType))},param(){const{createStaff:e,supplierNbr:t,supplierRuleNo:a,ruleId:i}=this.detailData;return{userId:e,supplierNbr:t,supplierRuleNo:a,ruleId:i}}},mounted(){this.queryRuleStrategyDetail(),this.queryRuleSimRecordList()},methods:{queryRuleStrategyDetail(){const e=this.$route.query.ruleId;this.$api.rule.queryRuleStrategyDetail({ruleId:e}).then((e=>{1==e.objType?e.objTypeName=this.$t("rule.enterprise"):2==e.objType?e.objTypeName=this.$t("rule.package"):3==e.objType?e.objTypeName=this.$t("rule.simCard"):e.objTypeName="-",this.detailData=e}))},queryRuleSimRecordList(){const{supplierNbr:e,ruleSubType:t}=this.$route.query;if(e===r.HW||e===r.P4||(0,o.Xp)(Number(t)))return void(this.tableVisible=!1);const a=this.$route.query.ruleId;this.$api.rule.queryRuleSimRecordList({ruleId:a}).then((e=>{e.list&&e.list.length>0?(this.tableData=e.list,this.page.total=e.total):(this.tableData=[],this.page.total=0)}))},handleSizeChange(e){this.page.pageSize=e,this.page.pageIndex=1,this.queryRuleSimRecordList()},handleCurrentChange(e){this.page.pageIndex=e,this.queryRuleSimRecordList()},clickUpload(e){this.showUpload=!0,this.queryId=e}}},u=n,d=a(43736),c=(0,d.Z)(u,i,s,!1,null,"4cfb45dd",null),p=c.exports},48076:function(e,t,a){a.d(t,{HW:function(){return l},P4:function(){return s},hm:function(){return i}});const i=[{value:"100000",label:"在用",key:"use"},{value:"120000",label:"停机",key:"stop"},{value:"140002",label:"未激活",key:"unactivated"}],s="121215042193",l="160605376671"},80289:function(e,t,a){a.d(t,{IC:function(){return x},T8:function(){return _},X8:function(){return C},Xp:function(){return v},ZN:function(){return $},b6:function(){return S},ex:function(){return y},hG:function(){return w},hR:function(){return U},o3:function(){return T}});const i=101,s=201,l=301,r=102,o=501,n=502,u=601,d=1,c=2,p=3,h=5,m=6,b=1,f=2,g=3;function v(e){return[u,o,r,n].find((t=>t===e))}function y(e){const t={[i]:d,[s]:c,[l]:p,[r]:d,[o]:h,[n]:h,[u]:m};return t[e]}function $(e){return e===b?"rule.enterprise":e===f?"rule.package":e===g?"rule.simCard":""}const _={[i]:"rule.monthDataUsage",[s]:"rule.monthSmsUsage",[l]:"rule.monthVoiceUsage",[u]:"rule.packageExpire",[o]:"rule.simStatusChange",[n]:"rule.deviceChange",[r]:"rule.monthOverflow"};function w(e){return _[e]||""}const U={[d]:"rule.dataRuleType",[c]:"rule.smsRuleType",[p]:"rule.voiceRuleType",[h]:"rule.cardRuleType",[m]:"rule.package"};function x(e){return U[e]}function S(e){return e===i?"rule.dataUnit":e===s?"rule.smsUnit":e===l?"rule.voiceUnit":""}function C(e){return`rule.sendState${e}`}function T(e){e.objId=e.offerId,e.objDesc=e.offerName}}}]);
//# sourceMappingURL=986.e0ecbaf6.js.map