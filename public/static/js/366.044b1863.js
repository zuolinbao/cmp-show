"use strict";(self["webpackChunkcmp"]=self["webpackChunkcmp"]||[]).push([[366],{98366:function(e,t,a){a.r(t),a.d(t,{default:function(){return P}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("ApiIntro"),t("div",{staticClass:"container-content"},[t("div",{staticClass:"container-header"},[t("div",{staticClass:"header-title"},[t("div",{staticClass:"header-left"},[e._v(e._s(e.$t("api.gwUserId")+e.detailInfo.gwUserId))])]),t("div",{staticClass:"header-info"},[t("el-row",{staticClass:"header-info-bottom",attrs:{gutter:20}},e._l(e.infoList,(function(a){return t("el-col",{key:a.prop,attrs:{span:4}},[t("div",[e._v(e._s(a.label))]),t("div",{staticClass:"info-value-container"},[t("el-tooltip",{attrs:{effect:"dark",content:e.itemInfoFormatter(a),placement:"top",disabled:!e.isShowTooltip}},[t("div",{ref:"infoValue",refInFor:!0,staticClass:"info-value",on:{mouseenter:e.onMouseOver}},[e._v(" "+e._s(e.itemInfoFormatter(a))+" ")])]),"Secret_Key"===a.label?t("div",{staticClass:"info-action"},[t("a",{staticClass:"el-icon-view cor-blue",on:{click:e.viewPlain}}),t("a",{directives:[{name:"compPriv",rawName:"v-compPriv",value:48,expression:"48"}],staticClass:"el-icon-edit-outline cor-blue",on:{click:e.editPassword}})]):e._e()],1)])})),1)],1)])]),t("ViewPlainDialog",{attrs:{visible:e.plainDialogVisible,"record-id":e.recordId},on:{"update:visible":function(t){e.plainDialogVisible=t},refresh:e.viewPlainSuccess}}),t("ResetDialog",{attrs:{visible:e.resetDialogVisible,"record-id":e.recordId},on:{"update:visible":function(t){e.resetDialogVisible=t},refresh:function(t){return e.qryCmpParamPage()}}})],1)},s=[],o=a(45101),r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"api-intro"},[t("div",{staticClass:"api-intro-left"},[t("div",{staticClass:"title"},[e._v(e._s(e.$t("api.intro")))]),t("div",{staticClass:"des"},[e._v(" "+e._s(e.$t("api.introDes1"))),t("br"),e._v(" "+e._s(e.$t("api.introDes2"))+" ")])]),t("img",{staticClass:"api-intro-right",attrs:{src:a(56674)}})])},l=[],n={},c=n,m=a(43736),d=(0,m.Z)(c,r,l,!1,null,"013b7780",null),p=d.exports,u=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.$t("api.apiEdit"),visible:e.v,"before-close":e.handleClose,width:"520px","close-on-click-modal":!1,"append-to-body":""},on:{"update:visible":function(t){e.v=t}}},[t("el-form",{ref:"paramFormRef",staticClass:"demo-ruleForm",attrs:{model:e.paramForm,rules:e.paramRules,size:"small"}},[t("el-form-item",{attrs:{label:e.$t("api.currentEmail"),prop:"email"}},[t("el-input",{attrs:{disabled:""},model:{value:e.paramForm.email,callback:function(t){e.$set(e.paramForm,"email",t)},expression:"paramForm.email"}})],1),t("el-form-item",{attrs:{label:e.$t("api.checkCode"),prop:"checkCode"}},[t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{span:19}},[t("el-input",{attrs:{placeholder:e.inputPh("api.checkCode")},model:{value:e.paramForm.checkCode,callback:function(t){e.$set(e.paramForm,"checkCode",t)},expression:"paramForm.checkCode"}})],1),t("el-col",{attrs:{span:3}},[e.countingDown?t("el-button",{attrs:{disabled:!0}},[e._v(e._s(e.$t("login.countDown",{countDownNum:e.countDownTime})))]):t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.sendSms}},[e._v(e._s(e.$t("api.sendCode")))])],1)],1)],1),t("el-form-item",{attrs:{label:e.$t("api.oldSecret"),prop:"oldSecretKey"}},[t("el-input",{attrs:{"show-password":"",placeholder:e.inputPh("api.oldSecret")},model:{value:e.paramForm.oldSecretKey,callback:function(t){e.$set(e.paramForm,"oldSecretKey",t)},expression:"paramForm.oldSecretKey"}})],1),t("el-form-item",{attrs:{label:e.$t("api.newSecret"),prop:"newSecretKey"}},[t("el-input",{attrs:{"show-password":"",placeholder:e.inputPh("api.newSecret")},model:{value:e.paramForm.newSecretKey,callback:function(t){e.$set(e.paramForm,"newSecretKey",t)},expression:"paramForm.newSecretKey"}})],1),t("div",{staticClass:"tip"},[e._v(" "+e._s(e.$t("api.secretTip"))+" ")])],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.clickOk}},[e._v(e._s(e.$t("common.ok")))]),t("el-button",{attrs:{size:"small"},on:{click:e.cancel}},[e._v(e._s(e.$t("common.cancel")))])],1)],1)],1)},h=[],f=a(41090),v={mixins:[f.Z],props:{visible:{type:Boolean,default:!1},recordId:{type:[String,Number],default:""},modifyForm:{type:Object,default:()=>null}},data(){return{countDownTime:60,countingDown:!1,paramForm:{},defaultForm:{email:this.$store.state.user.user.email,checkCode:""},paramRules:{email:[{required:!0,message:"请输入",trigger:"blur"}],checkCode:[{required:!0,message:"请输入",trigger:"blur"}],oldSecretKey:[{required:!0,message:"请输入旧密钥"},{validator:this.validatePassword,trigger:"blur"}],newSecretKey:[{required:!0,message:"请输入新密钥"},{validator:this.validatePassword,trigger:"blur"}]}}},computed:{v:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}}},watch:{visible(e){e&&(this.modifyForm?this.paramForm={...this.modifyForm}:this.paramForm={...this.defaultForm})}},mounted(){},methods:{clickOk(){this.$refs.paramFormRef.validate((e=>{e&&(0,o.Z)("/apiGateway/updateGwUserSecretByCheckCode",{...this.paramForm,recordId:this.recordId},{method:"post"}).then((e=>{this.$refs.paramFormRef.resetFields(),this.$message.success("修改成功！"),this.v=!1,this.$emit("refresh")}))}))},async sendSms(){await(0,o.Z)("/user/sendMail",{sceneCode:"updateApiSecretKey"},{method:"get"}),this.$message.success("发送成功!"),this.startCountDown()},startCountDown(){this.countingDown=!0;const e=setInterval((()=>{this.countDownTime>1?this.countDownTime--:(clearInterval(e),this.resetCountDown())}),1e3)},resetCountDown(){this.countingDown=!1,this.countDownTime=60},cancel(){this.resetCountDown(),this.$refs.paramFormRef.clearValidate(),this.v=!1},handleClose(){this.cancel()},validatePassword(e,t,a){/^(?=.*[a-z])(?=.*[A-Z])[A-Za-z\d]{9}$/.test(t)?a():a(new Error("请输入9位大小写字母和数字组合"))}}},w=v,b=(0,m.Z)(w,u,h,!1,null,"692abd3b",null),g=b.exports,C=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.$t("api.viewPlain"),visible:e.v,"before-close":e.handleClose,width:"520px","close-on-click-modal":!1,"append-to-body":""},on:{"update:visible":function(t){e.v=t}}},[t("el-form",{ref:"paramFormRef",attrs:{model:e.paramForm,rules:e.paramRules,size:"small"}},[t("el-form-item",{attrs:{label:e.$t("api.currentEmail"),prop:"email"}},[t("el-input",{attrs:{disabled:""},model:{value:e.paramForm.email,callback:function(t){e.$set(e.paramForm,"email",t)},expression:"paramForm.email"}})],1),t("el-form-item",{attrs:{label:e.$t("api.checkCode"),prop:"checkCode"}},[t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{span:19}},[t("el-input",{attrs:{placeholder:e.inputPh("api.checkCode")},model:{value:e.paramForm.checkCode,callback:function(t){e.$set(e.paramForm,"checkCode",t)},expression:"paramForm.checkCode"}})],1),t("el-col",{attrs:{span:3}},[e.countingDown?t("el-button",{key:"2",attrs:{disabled:""}},[e._v(e._s(e.$t("login.countDown",{countDownNum:e.countDownTime})))]):t("el-button",{key:"1",attrs:{type:"primary",size:"small"},on:{click:e.sendSms}},[e._v(e._s(e.$t("api.sendCode")))])],1)],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{loading:e.loading,type:"primary",size:"small"},on:{click:e.clickOk}},[e._v(e._s(e.$t("common.ok")))]),t("el-button",{attrs:{size:"small"},on:{click:e.cancel}},[e._v(e._s(e.$t("common.cancel")))])],1)],1)],1)},y=[],$={mixins:[f.Z],props:{visible:{type:Boolean,default:!1},recordId:{type:[String,Number],default:""},modifyForm:{type:Object,default:()=>null}},data(){return{paramForm:{},loading:!1,countDownTime:60,countingDown:!1,defaultForm:{email:this.$store.state.user.user.email,checkCode:""},paramRules:{email:[{required:!0,message:"请输入",trigger:"blur"}],checkCode:[{required:!0,message:"请输入验证码"}]}}},computed:{v:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}}},watch:{visible(e){e&&(this.modifyForm?this.paramForm={...this.modifyForm}:this.paramForm={...this.defaultForm},this.$nextTick((()=>{this.$refs.paramFormRef.clearValidate()})))}},mounted(){},methods:{clickOk(){this.$refs.paramFormRef.validate((async e=>{if(!e)return;this.loading=!0;const t=await(0,o.Z)("/apiGateway/qryGwUserSecretByCheckCode",{...this.paramForm,recordId:this.recordId},{method:"get"}).finally((()=>this.loading=!1));this.$refs.paramFormRef.resetFields(),this.$message.success("查看成功！"),this.v=!1,this.$emit("refresh",t)}))},async sendSms(){await(0,o.Z)("/user/sendMail",{sceneCode:"qryApiSecretKey"},{method:"get"}),this.$message.success("发送成功!"),this.startCountDown()},startCountDown(){this.countingDown=!0;const e=setInterval((()=>{this.countDownTime>1?this.countDownTime--:(clearInterval(e),this.resetCountDown())}),1e3)},resetCountDown(){this.countingDown=!1,this.countDownTime=60},cancel(){this.resetCountDown(),this.$refs.paramFormRef.clearValidate(),this.v=!1},handleClose(){this.cancel()}}},F=$,k=(0,m.Z)(F,C,y,!1,null,"3f0be576",null),D=k.exports,_={components:{ApiIntro:p,ViewPlainDialog:D,ResetDialog:g},data(){return{isShowTooltip:!0,plainDialogVisible:!1,resetDialogVisible:!1,recordId:"",info:{},detailInfo:{}}},computed:{infoList(){return[{label:this.$t("api.gwUserName"),prop:"gwUserName"},{label:this.$t("api.cmpUserCode"),prop:"cmpUserCode"},{label:this.$t("api.cmpUserName"),prop:"cmpUserName"},{label:this.$t("api.appKey"),prop:"appKey"},{label:this.$t("api.secretKey"),prop:"secretKey"},{label:this.$t("api.createUserCode"),prop:"createUserCode"},{label:this.$t("api.createDate"),prop:"createDate"},{label:this.$t("api.updateUserCode"),prop:"updateUserCode"},{label:this.$t("api.updateDate"),prop:"updateDate"}]}},mounted(){this.qryCmpParamPage()},methods:{itemInfoFormatter(e){const t=e.formatter?e.formatter(this.detailInfo[e.prop]):this.detailInfo[e.prop]||"-";return t},async qryCmpParamPage(){const e={pageIndex:1,pageSize:1};this.loading=!0;const t=await(0,o.Z)("/apiGateway/gatewayAccountList",e,{method:"post"});this.recordId=t.list[0].recordId??"",this.gatewayAccountDetail()},async gatewayAccountDetail(e){const t=await(0,o.Z)("/apiGateway/gatewayAccountDetail",{recordId:this.recordId},{method:"get"}).finally((()=>{this.loading=!1}));this.detailInfo=t},viewPlain(){this.plainDialogVisible=!0},viewPlainSuccess(e){this.detailInfo={...this.detailInfo,secretKey:e}},editPassword(){this.resetDialogVisible=!0},onMouseOver(e){const t=e.target,a=t.clientWidth,i=t.scrollWidth;this.isShowTooltip=i>a}}},I=_,S=(0,m.Z)(I,i,s,!1,null,"c00298dc",null),P=S.exports},56674:function(e,t,a){e.exports=a.p+"static/img/api_front.3225a12a.png"}}]);
//# sourceMappingURL=366.044b1863.js.map