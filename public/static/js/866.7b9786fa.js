"use strict";(self["webpackChunkcmp"]=self["webpackChunkcmp"]||[]).push([[866],{65338:function(t,e,a){a.d(e,{Z:function(){return c}});var s=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{"close-on-click-modal":!1,title:t.title,visible:t.v,"append-to-body":!0,width:"840px",top:"10vh"},on:{"update:visible":function(e){t.v=e}}},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{"element-loading-text":t.$t("batchUpload.uploading")}},[e("p",{staticClass:"download-tip"},[t._v(" "+t._s(t.$t("batchUpload.please"))),e("a",{staticClass:"cor-blue",attrs:{target:"_self"},on:{click:t.downloadTpl}},[t._v(t._s(t.$t("batchUpload.downloadTpl")))]),t._v(t._s(t.$t("batchUpload.please2"))+" ")]),e("div",{staticClass:"tip"},[e("i",{staticClass:"icon-zhuyi",staticStyle:{color:"orange"}}),e("p",{staticClass:"upload-tip"},[t._v(" "+t._s(t.$t("batchUpload.warmTip"))),e("br"),t._t("tip")],2)]),e("div",{staticClass:"upload-box"},[e("el-upload",{ref:"upload",staticClass:"upload-wrap",attrs:{drag:"",accept:".xls,.xlsx",action:t.action,data:t.extraParam,"show-file-list":!0,multiple:!1,"auto-upload":!1,"file-list":t.fileList,"on-change":t.handlerChange,"on-remove":t.handleRemove,"on-progress":t.handlerProgress,"on-success":t.handlerSuccess,"on-error":t.handlerError,"before-upload":t.beforeUpload}},[e("div",{staticClass:"upload_file_choose"},[e("i",{staticClass:"el-icon-upload cor-blue"}),e("div",{staticClass:"upload_file_choose_text"},[t._v(" "+t._s(t.$t("batchUpload.drag1"))),e("em",[t._v(t._s(t.$t("batchUpload.drag2")))]),e("br"),e("span",{staticClass:"support-tip"},[t._v(t._s(t.supportFormat))])])])])],1),e("div",{staticClass:"download-template"},[e("el-button",{attrs:{type:"text",icon:"icon-xiazai1"},on:{click:t.downloadTpl}},[t._v(t._s(t.$t("batchUpload.downloadTpl"))+" ")])],1)]),e("span",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary",disabled:t.disableSubmit},on:{click:t.submit}},[t._v(t._s(t.$t("batchUpload.submit")))]),e("el-button",{on:{click:function(e){t.v=!1}}},[t._v(t._s(t.$t("common.cancel")))])],1)])},i=[],o=(a(70560),{components:{},props:{visible:{type:Boolean,default:!1},queryId:{type:[String,Number],default:""},downloadUrl:{type:String,default:"/batch/downloadTpl/"},uploadUrl:{type:String,default:"/batch/import"},maxFileSize:{type:Number,default:10485760},title:{type:String,default:""},param:{type:Object,default:()=>{}},isXls:{type:Boolean,default:!1},isRuleBatch:{type:Boolean,default:!1}},data(){return{uploaded:!1,loading:!1,fileName:"",fileSize:0,fileList:[]}},computed:{v:{get:function(){return this.visible},set:function(t){this.$emit("update:visible",t),t||(this.fileList=[])}},supportFormat(){return this.$t("batchUpload.drag3")+" "+(this.isXls?".xls":".xlsx")},action(){return"/api"+this.uploadUrl},isSpecial(){return"/simCard/upload"===this.uploadUrl||"/order/upload"===this.uploadUrl},disableSubmit(){return!this.fileName||this.loading},extraParam(){return this.isSpecial||this.isRuleBatch?{templateId:this.queryId,...this.param}:{queryId:this.queryId,...this.param}},showPreview(){return!this.uploaded&&this.fileName},fileSizeFormat(){return this.fileSize>1048576?(this.fileSize/1024/1024).toFixed(2)+"MB":(this.fileSize/1024).toFixed(2)+"KB"}},methods:{downloadTpl(){window.open(this.downloadUrl+this.queryId,"_self")},handlerProgress(t,e,a){this.loading=!0,this.fileName=e.name,this.fileSize=e.size},handlerChange(t,e){console.log("handlerChange",t,e),e.length>1&&e.splice(0,1),this.uploaded||(this.fileName=t.name,this.fileSize=t.size)},handleRemove(t,e){this.resetUpload()},handlerSuccess(t,e,a){if(t.data&&t.data.length>0)return void this.errAlert(t.data);if("0"!=t.code&&t.message)return void this.errAlert(t.message);this.uploaded=!0;const s=setTimeout((()=>{this.loading=!1,clearTimeout(s)}),200);if(this.isSpecial)this.$message.success(this.$t("batchUpload.subtmitSuccess")),this.uploaded=!1,this.v=!1;else{const t=this,e=this.$createElement;this.$msgbox({title:this.$t("batchUpload.subtmitSuccess"),type:"success",center:!0,message:e("p",{class:"fs12"},[this.$t(this.isRuleBatch?"batchUpload.task2":"batchUpload.task"),e("a",{class:"cor-blue",on:{click:t.viewProgress}},this.$t("batchUpload.process"))]),showCancelButton:!1,confirmButtonText:this.$t("batchUpload.know")}).then((()=>{this.uploaded=!1,this.v=!1})).catch((()=>{}))}},resetUpload(){this.$refs.upload.clearFiles(),this.uploaded=!1,this.fileName="",this.fileSize=0},showErrMsg(t){this.$msgbox({title:this.$t("batchUpload.subtmitFail"),type:"warning",center:!0,message:t,showCancelButton:!1,confirmButtonText:this.$t("batchUpload.know")})},handlerError(t){const e=setTimeout((()=>{this.loading=!1,clearTimeout(e)}),200);let a=this.$t("batchUpload.systemError");if(t.message){const e=JSON.parse(t.message);e&&e.message&&(a+="，"+e.message)}this.showErrMsg(a),this.$nextTick(this.resetUpload)},errAlert(t){this.$nextTick(this.resetUpload);const e=setTimeout((()=>{this.loading=!1,clearTimeout(e)}),200),a=this.$createElement,s=a("div",{class:"error-msg-box"},[...function(){const e=[];return t.forEach((t=>{e.push(a("p",{class:"cor-red"},t))})),e}()]);this.showErrMsg(s)},toReload(){this.resetUpload()},submit(){this.$refs.upload.submit()},beforeUpload(t){if(this.fileSize>this.maxFileSize){let t="";return t=this.maxFileSize>1048576?this.maxFileSize/1024/1024+"MB":this.maxFileSize/1024+"KB",this.$message.error(this.$t("batchUpload.fileSize")+t),!1}return"application/vnd.ms-excel"===t.type||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===t.type||(this.$message.error(this.$t("batchUpload.fileType")),!1)},viewProgress(){this.uploaded=!1,this.v=!1,this.$msgbox.close(),this.isRuleBatch?this.$router.push({path:"/order/orderBatch",query:{activeTab:"2"}}):this.$router.push("/common/download")}}}),l=o,r=a(1001),n=(0,r.Z)(l,s,i,!1,null,"79240383",null),c=n.exports},91866:function(t,e,a){a.r(e),a.d(e,{default:function(){return h}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container"},[e("div",{staticClass:"container-content"},[e("el-row",{staticClass:"container-top",attrs:{gutter:20}},t._l(t.infoList,(function(a){return e("el-col",{key:a.prop,attrs:{span:4}},[e("CtTooltip",{attrs:{label:a.label,content:t.itemInfoFormatter(a)}})],1)})),1),e("div",{staticClass:"container-bottom"},[e("div",{staticClass:"container-form"},[e("ct-section-title",{staticClass:"content-info-title",attrs:{title:"关联号码"}}),e("el-form",{ref:"qryParamRef",attrs:{model:t.qryParam,size:"small"}},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:5}},[e("el-form-item",{attrs:{label:"ICCID",prop:"iccid"}},[e("el-input",{attrs:{placeholder:t.inputPh("ICCID")},model:{value:t.qryParam.iccid,callback:function(e){t.$set(t.qryParam,"iccid",e)},expression:"qryParam.iccid"}})],1)],1),e("el-col",{attrs:{span:5}},[e("el-form-item",{attrs:{label:t.$t("accountMag.simStatus"),prop:"statusCd"}},[e("ct-select",{attrs:{options:t.statusOptions,placeholder:t.selectPh("accountMag.simStatus")},model:{value:t.qryParam.statusCd,callback:function(e){t.$set(t.qryParam,"statusCd",e)},expression:"qryParam.statusCd"}})],1)],1),e("el-col",{attrs:{span:14}},[e("el-form-item",[e("div",{staticClass:"search-button-group"},[e("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(e){return t.loadData(!1)}}},[t._v(t._s(t.$t("common.query")))]),e("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:t.reset}},[t._v(t._s(t.$t("common.reset")))])],1)])],1)],1),e("div",{directives:[{name:"compPriv",rawName:"v-compPriv",value:34,expression:"34"}],staticClass:"tool-button-group"},[e("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(e){return t.batchClick(1e3)}}},[t._v(t._s(t.$t("common.batchImport")))]),e("el-button",{attrs:{icon:"el-icon-delete",type:"danger",plain:""},on:{click:function(e){return t.batchClick(1001)}}},[t._v(" "+t._s(t.$t("common.batchDelete")))])],1)],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"table",attrs:{data:t.tableData,border:!0}},[e("el-table-column",{attrs:{prop:"iccid",label:"ICCID","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"msisdn",label:"MSISDN","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"statusCd",label:t.$t("accountMag.simStatus"),formatter:t.rowFormatter,"show-overflow-tooltip":""}}),e("el-table-column",{attrs:{label:t.$t("common.action"),fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"action-button-group"},[e("el-button",{directives:[{name:"compPriv",rawName:"v-compPriv",value:37,expression:"37"}],staticClass:"cor-red",attrs:{type:"text"},on:{click:function(e){return t.clickDelete(a.row)}}},[t._v(t._s(t.$t("common.delete")))])],1)]}}])})],1),e("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.tableData.length>0,expression:"tableData.length > 0"}],attrs:{background:"","current-page":t.page.pageIndex,align:"right","page-sizes":[10,20,50,100],"page-size":t.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.page.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])],1),t.showUpload?e("BatchUpload",{attrs:{visible:t.showUpload,"query-id":t.queryId,"download-url":"/order/download/","upload-url":"/simCard/upload","max-file-size":10485760,param:{userId:t.userId},title:t.uploadTitle},on:{"update:visible":function(e){t.showUpload=e}},scopedSlots:t._u([{key:"tip",fn:function(){return[t._v(" 1、"+t._s(t.$t("batchUpload.uploadTip1"))),e("br"),t._v(" 2、"+t._s(t.$t("batchUpload.uploadTip2"))),e("br"),t._v(" 3、"+t._s(t.$t("batchUpload.uploadTip3"))),e("br"),t._v(" 4、"+t._s(t.$t("batchUpload.uploadTip4"))+" ")]},proxy:!0}],null,!1,1330438206)}):t._e()],1)},i=[],o=a(23060),l=a(65338),r=a(88434),n=a(58439),c={components:{BatchUpload:l.Z},mixins:[o.Z],props:{},data(){return{showUpload:!1,queryId:"",userId:this.$route.query.userId,tableData:[],loading:!1,page:{pageIndex:1,pageSize:10,total:0},detailInfo:{},activeTab:"1",qryParam:{accNum:"",statusCd:""}}},computed:{statusOptions(){return n.hm.map((t=>({...t,label:this.$t("simMag."+t.key)})))},infoList(){return[{label:this.$t("accountMag.account"),prop:"userCode"},{label:this.$t("accountMag.userName"),prop:"userName"},{label:this.$t("accountMag.email"),prop:"email"},{label:this.$t("accountMag.phone"),prop:"phone"},{label:this.$t("accountMag.fax"),prop:"fax"},{label:this.$t("common.remark"),prop:"remark"}]},uploadTitle(){return 1e3===this.queryId?this.$t("common.batchImport"):this.$t("common.batchDelete")}},mounted(){this.queryDetail(),this.loadData(!1)},methods:{rowFormatter(t,e,a){const s=this.statusOptions.find((t=>t.value===a));return s?this.$t("simMag."+s.key):a},async queryDetail(){const t=await(0,r.Z)("/user/querySystemUserDetail",{userId:this.userId,modifyFlag:0},{method:"get"}),e={...t};e.emailDesc&&(e.email=e.emailDesc),e.faxDesc&&(e.fax=e.faxDesc),e.mobileDesc&&(e.mobile=e.mobileDesc),e.phoneDesc&&(e.phone=e.phoneDesc),e.userNameDesc&&(e.userName=e.userNameDesc),this.detailInfo={...e}},async loadData(t){t||(this.page.pageIndex=1,this.page.pageSize=10);const e={userId:this.userId,...this.qryParam,pageInfo:this.page};this.loading=!0;const a=await(0,r.Z)("/user/queryUserSimCardPage",e,{method:"post"}).finally((()=>{this.loading=!1}));this.tableData=a.result||[],this.page.total=a.rowCount},itemInfoFormatter(t){const e=t.formatter?t.formatter(this.detailInfo[t.prop]??"-"):this.detailInfo[t.prop]??"-";return e},handleSizeChange(t){this.page.pageSize=t,this.page.pageIndex=1,this.loadData(!0)},handleCurrentChange(t){this.page.pageIndex=t,this.loadData(!0)},batchClick(t){this.queryId=t,this.showUpload=!0},async clickDelete(t){const e={userId:this.userId};t.iccid?(e.type="iccid",e.accNums=[t.iccid]):t.msisdn&&(e.type="msisdn",e.accNums=[t.msisdn]),this.$confirm(this.$t("accountMag.deleteAsk"),{confirmButtonText:this.$t("common.yes"),cancelButtonText:this.$t("common.no"),type:"warning"}).then((async()=>{this.loading=!0,await(0,r.Z)("/user/unBindSimCard",e,{method:"post"}).finally((()=>{this.loading=!1})),this.$message.success(this.$t("common.deleteSuccess")),this.loadData(!1)}))},reset(){this.$refs.qryParamRef.resetFields(),this.loadData(!1)}}},d=c,p=a(1001),u=(0,p.Z)(d,s,i,!1,null,"30edaea5",null),h=u.exports},58439:function(t,e,a){a.d(e,{HW:function(){return o},P4:function(){return i},hm:function(){return s}});const s=[{value:"100000",label:"在用",key:"use"},{value:"120000",label:"停机",key:"stop"},{value:"140002",label:"未激活",key:"unactivated"}],i="121215042193",o="160605376671"}}]);
//# sourceMappingURL=866.7b9786fa.js.map